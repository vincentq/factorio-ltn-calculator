<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link href="css/style.css" rel="stylesheet">
    <title>Factorio LTN Calculator</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
  <a class="navbar-brand" href="#">Factorio LTN Tools</a>
  <button class="navbar-toggler" type="button" data-toggle="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarsExampleDefault">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Network ID<span class="sr-only">(current)</span></a>
      </li>
    </ul>
  </div>
</nav>

<main role="main" class="container-fluid">

  <div class="starter-template">
    <h1>Factorio LTN Network ID calculator</h1>
    <p class="lead">This tool will calculate values for LTN Network IDs that can be entered into the input combinator.</p>

    <div class="form-inline d-flex justify-content-center">
    <div class="input-group mb-4">
      <input type="text" class="form-control calc-value" placeholder="Enter network ID" aria-label="Network ID" aria-describedby="basic-addon2">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary calc-button" type="button">Calculate</button>
      </div>
     </div>
    </div>
    
<div class="d-flex flex-wrap justify-content-center">
<div class="btn-toolbar">
  <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">1</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">2</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">3</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">4</button>
  </div>
  <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">5</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">6</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">7</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">8</button>
  </div>
  </div>
  <div class="btn-toolbar">
    <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">9</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">10</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">11</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">12</button>
  </div>
  <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">13</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">14</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">15</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">16</button>
  </div>
   </div>
  <div class="btn-toolbar">
    <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">17</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">18</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">19</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">20</button>
  </div>
  <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">21</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">22</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">23</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">24</button>
  </div>
   </div>
  <div class="btn-toolbar">
    <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">25</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">26</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">27</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">28</button>
  </div>
  <div class="btn-group mr-2 mb-3" role="group">
    <button type="button" data-toggle="button" class="btn btn-outline-primary">29</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">30</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">31</button>
    <button type="button" data-toggle="button" class="btn btn-outline-primary">32</button>
  </div>
</div>
  </div><!-- button group -->
  
<div class="mb-2">
    <button type="button" class="btn btn-secondary ltn-select-all mr-2">Select All</button> 
    <button type="button" class="btn btn-secondary ltn-select-none mr-2">Select None</button>
    <button type="button" class="btn btn-secondary ltn-invert">Invert Selection</button>
</div>
  <p>Network ID value: <strong style="font-size: 200%" class="result-decimal">0</strong> <small>(<span class="result-hex">0000 0000</span>)</small></p>
  
  <p class="hidden zero-note"><em>A network ID of zero or an unset value results in default behaviour where the station is in every network (same as network ID of -1). </em></p>
</div>
</main><!-- /.container -->
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    
    <script>
        $(document).ready(function() {
            
            var ltnCalc = function() {
                $(".result-decimal").hide();
                setTimeout(function() { // This is needed because the click handler seems to fire before Bootstrap toggle changes the active state
                    var networkID = 0;
                    $(".btn-toolbar button").each(function() {
                       if ($(this).hasClass("active")) {
                           networkID += Math.pow(2,parseInt($(this).text())-1);
                       } 
                    });
                    $(".result-decimal").text(uintToInt(networkID, 32));
                    var hex = networkID.toString(16).padStart(8,'0')
                    $(".result-hex").text(hex.substring(0,4)+" "+hex.substring(4));
                    $(".result-decimal").show(100);
                    if (networkID == 0) {
                        $(".zero-note").show();
                    } else {
                        $(".zero-note").hide();
                }
                });
            }
            
            $(".calc-button").click(function() {
                var calcValue = parseInt($(".calc-value").val());
                if (isNaN(calcValue)) return;
                $(".btn-toolbar button").removeClass("active"); 
                $(".btn-toolbar button").each(function() {
                    var pos = parseInt($(this).text());
                    $(this).removeClass("active");
                    if (Math.pow(2,pos-1) & calcValue) {
                        $(this).addClass("active");
                    }
                });
            })
            
            $(".btn").on('click',ltnCalc);
            
            $(".ltn-select-all").click(function() {
               $(".btn-toolbar button").addClass("active"); 
            });
            $(".ltn-select-none").click(function() {
               $(".btn-toolbar button").removeClass("active"); 
            });
            $(".ltn-invert").click(function() {
               $(".btn-toolbar button").each(function() {
                    if($(this).hasClass("active")) $(this).removeClass("active");
                    else $(this).addClass("active");
                });
            });
            
            ltnCalc();
        });
        
        function uintToInt(uint, nbit) {
            nbit = +nbit || 32;
            if (nbit > 32) throw new RangeError('uintToInt only supports ints up to 32 bits');
            uint <<= 32 - nbit;
            uint >>= 32 - nbit;
            return uint;
        }
    </script>
  </body>
</html>